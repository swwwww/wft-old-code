!function(a){a.Callbacks=function(b){b=a.extend({},b);var c,d,e,f,g,h,i=[],j=!b.once&&[],k=function(a){for(c=b.memory&&a,d=!0,h=f||0,f=0,g=i.length,e=!0;i&&g>h;++h)if(i[h].apply(a[0],a[1])===!1&&b.stopOnFalse){c=!1;break}e=!1,i&&(j?j.length&&k(j.shift()):c?i.length=0:l.disable())},l={add:function(){if(i){var d=i.length,h=function(c){a.each(c,function(a,c){"function"==typeof c?b.unique&&l.has(c)||i.push(c):c&&c.length&&"string"!=typeof c&&h(c)})};h(arguments),e?g=i.length:c&&(f=d,k(c))}return this},remove:function(){return i&&a.each(arguments,function(b,c){for(var d;(d=a.inArray(c,i,d))>-1;)i.splice(d,1),e&&(g>=d&&--g,h>=d&&--h)}),this},has:function(b){return!(!i||!(b?a.inArray(b,i)>-1:i.length))},empty:function(){return g=i.length=0,this},disable:function(){return i=j=c=void 0,this},disabled:function(){return!i},lock:function(){return j=void 0,c||l.disable(),this},locked:function(){return!j},fireWith:function(a,b){return!i||d&&!j||(b=b||[],b=[a,b.slice?b.slice():b],e?j.push(b):k(b)),this},fire:function(){return l.fireWith(this,arguments)},fired:function(){return!!d}};return l}}(Zepto),function(a){function b(c){var d=[["resolve","done",a.Callbacks({once:1,memory:1}),"resolved"],["reject","fail",a.Callbacks({once:1,memory:1}),"rejected"],["notify","progress",a.Callbacks({memory:1})]],e="pending",f={state:function(){return e},always:function(){return g.done(arguments).fail(arguments),this},then:function(){var c=arguments;return b(function(b){a.each(d,function(d,e){var h=a.isFunction(c[d])&&c[d];g[e[1]](function(){var c=h&&h.apply(this,arguments);if(c&&a.isFunction(c.promise))c.promise().done(b.resolve).fail(b.reject).progress(b.notify);else{var d=this===f?b.promise():this,g=h?[c]:arguments;b[e[0]+"With"](d,g)}})}),c=null}).promise()},promise:function(b){return null!=b?a.extend(b,f):f}},g={};return a.each(d,function(a,b){var c=b[2],h=b[3];f[b[1]]=c.add,h&&c.add(function(){e=h},d[1^a][2].disable,d[2][2].lock),g[b[0]]=function(){return g[b[0]+"With"](this===g?f:this,arguments),this},g[b[0]+"With"]=c.fireWith}),f.promise(g),c&&c.call(g,g),g}var c=Array.prototype.slice;a.when=function(d){var e,f,g,h=c.call(arguments),i=h.length,j=0,k=1!==i||d&&a.isFunction(d.promise)?i:0,l=1===k?d:b(),m=function(a,b,d){return function(f){b[a]=this,d[a]=arguments.length>1?c.call(arguments):f,d===e?l.notifyWith(b,d):--k||l.resolveWith(b,d)}};if(i>1)for(e=new Array(i),f=new Array(i),g=new Array(i);i>j;++j)h[j]&&a.isFunction(h[j].promise)?h[j].promise().done(m(j,g,h)).fail(l.reject).progress(m(j,f,e)):--k;return k||l.resolveWith(g,h),l.promise()},a.Deferred=b}(Zepto),function(a,b){"function"==typeof define&&define.amd?define(["$"],b):"object"==typeof exports?module.exports=b():a.Dialog=b(window.Zepto||window.jQuery||$)}(this,function(a){a.fn.Dialog=function(c){var d=[];return a(this).each(function(){var e=new b,f=a.extend({trigger:a(this)},c);e.init(f),d.push(e)}),d},a.Dialog=function(c){if("alert"===c.type){var d=new b,e='<div class="ui-alert-title">'+c.content+"</div>",f="";c.button?("boolean"==typeof c.button&&(c.button="确定"),f='<p class="ui-dialog-action"><button class="ui-alert-submit  js-dialog-close">'+c.button+"</button></p>"):c.timer||(c.timer=3e3),e+=f;var g=a.extend({target:e,animate:!0,show:!0,mask:!0,className:"ui-alert",afterHide:function(a){this.dispose(),c.callback&&c.callback()}},c);d.init(g),c.timer&&setTimeout(function(){d.dispose(),c.callback&&c.callback()},c.timer),d.touch(d.mask,function(){d.hide(),c.callback&&c.callback()})}if("confirm"===c.type){var h=new b,e='<div class="ui-confirm-title">'+c.content+"</div>",f="";c.buttons||(c.buttons=[{yes:"确定"},{no:"取消"}]);for(var i="",j=0,k=c.buttons.length;k>j;j++){var l=c.buttons[j];l.yes&&(i+='<td><button class="ui-confirm-submit " data-type="yes">'+l.yes+"</button></td>"),l.no&&(i+='<td><button class="ui-confirm-no" data-type="no">'+l.no+"</button></td>"),l.close&&(i+='<td><button class="ui-confirm-close js-dialog-close" data-type="close">'+l.close+"</button></td>")}f='<table class="ui-dialog-action"><tr>'+i+"</tr></table>",e+=f;var m=a.extend({target:e,animate:!0,show:!0,fixed:!0,mask:!0,className:"ui-alert",afterHide:function(a){this.dispose()},beforeShow:function(b){h.touch(a(".ui-confirm-submit",b),function(){c.callback&&c.callback.call(h,"yes",b)}),h.touch(a(".ui-confirm-no",b),function(){c.callback&&c.callback.call(h,"no",b)}),h.touch(a(".ui-confirm-close",b),function(){c.callback&&c.callback.call(h,"close",b)})}},c);h.init(m)}},a.alert=function(b,c,d,e,f){var g={},h={zIndex:100,type:"alert"};g="object"==typeof b?a.extend(h,b):a.extend(h,{content:b,button:c,timer:e,callback:d}),a.Dialog(a.extend(g,f))},a.confirm=function(b,c,d,e){var f={},g={zIndex:100,type:"confirm"};f="object"==typeof b?a.extend(g,b):a.extend(g,{content:b,buttons:c,callback:d}),a.Dialog(a.extend(f,e))};var b=function(){var b=Math.random().toString().replace(".","");this.id="dialog_"+b,this.settings={},this.settings.closeTpl=a('<span class="ui-dialog-close js-dialog-close">x</span>'),this.settings.titleTpl=a('<div class="ui-dialog-title"></div>'),this.timer=null,this.showed=!1,this.mask=a()};return b.prototype={init:function(b){this.settings=a.extend({fixed:!1},this.settings,b),this.settings.mask&&(this.mask=a('<div class="ui-dialog-mask"/>'),a("body").append(this.mask)),a("body").append('<div class="ui-dialog" id="'+this.id+'"></div>'),this.dialogContainer=a("#"+this.id);var c=this.settings.zIndex||10;this.dialogContainer.css({zIndex:c}),this.settings.className&&this.dialogContainer.addClass(this.settings.className),this.mask.css({zIndex:c-1}),this.settings.closeTpl&&this.dialogContainer.append(this.settings.closeTpl),this.settings.title&&(this.dialogContainer.append(this.settings.titleTpl),this.settings.titleTpl.html(this.settings.title)),this.bindEvent(),this.settings.show&&this.show()},touch:function(b,c){function d(a){return c.call(this,a)}var e;a(b).on("click",d),a(b).on("touchmove",function(a){e=!0}).on("touchend",function(a){if(a.preventDefault(),!e){var b=c.call(this,a,"touch");b||(a.preventDefault(),a.stopPropagation())}e=!1})},bindEvent:function(){var b=this;this.settings.trigger&&(a(this.settings.trigger).click(function(){b.show()}),b.touch(a(this.settings.trigger),function(){b.show()})),a(this.dialogContainer).on("click",".js-dialog-close",function(){return b.hide(),!1}),a(document).keydown(function(a){27===a.keyCode&&b.showed&&b.hide()}),a(this.dialogContainer).on("hide",function(){b.hide()})},dispose:function(){this.dialogContainer.remove(),this.mask.remove(),this.timer&&clearInterval(this.timer)},hide:function(){var b=this;b.settings.beforeHide&&b.settings.beforeHide.call(b,b.dialogContainer),this.showed=!1,this.mask.hide(),this.timer&&clearInterval(this.timer),this.settings.animate?(this.dialogContainer.removeClass("zoomIn").addClass("zoomOut"),setTimeout(function(){b.dialogContainer.hide(),"object"==typeof b.settings.target&&a("body").append(b.dialogContainer.hide()),b.settings.afterHide&&b.settings.afterHide.call(b,b.dialogContainer)},500)):(this.dialogContainer.hide(),"object"==typeof this.settings.target&&a("body").append(this.dialogContainer),this.settings.afterHide&&this.settings.afterHide.call(this,this.dialogContainer))},show:function(){"string"==typeof this.settings.target?/^(\.|\#\w+)/gi.test(this.settings.target)?this.dailogContent=a(this.settings.target):this.dailogContent=a("<div>"+this.settings.target+"</div>"):this.dailogContent=this.settings.target,this.mask.show(),this.dailogContent.show(),this.height=this.settings.height||"auto",this.width=this.settings.width||"auto",this.dialogContainer.append(this.dailogContent).show().css({height:this.height,width:this.width}),this.settings.beforeShow&&this.settings.beforeShow.call(this,this.dialogContainer),this.showed=!0,a(this.settings.trigger).blur(),this.setPosition();var b=this;this.timer&&clearInterval(this.timer),this.settings.fixed&&(this.timer=setInterval(function(){b.setPosition()},1e3)),this.settings.animate&&this.dialogContainer.addClass("zoomIn").removeClass("zoomOut").addClass("animated")},setPosition:function(){if(this.showed){var a=this;this.dialogContainer.show(),this.height=this.settings.height,this.width=this.settings.width,isNaN(this.height)&&(this.height=this.dialogContainer.outerHeight&&this.dialogContainer.outerHeight()||this.dialogContainer.height()),isNaN(this.width)&&(this.width=this.dialogContainer.outerWidth&&this.dialogContainer.outerWidth()||this.dialogContainer.width());var b=this.settings.clientHeight||document.documentElement.clientHeight||document.body.clientHeight,c=this.settings.clientWidth||document.documentElement.clientWidth||document.body.clientWidth,d=this.width/2,e=this.height/2,f=c/2-d,g=b/2-e;f=Math.floor(Math.max(0,f)),g=Math.floor(Math.max(0,g));var h="absolute";a.settings.fixed&&(h="fixed"),a.dialogContainer.css({position:h,top:g,left:f})}}},b}),function(a,b){"function"==typeof define&&define.amd?define(["$","dialog"],b):"function"==typeof define&&define.cmd?define(function(a,c,d){var e=a("$"),f=a("dialog");return b(e,f)}):"object"==typeof exports?module.exports=b():a.MobileSelectArea=b(window.Zepto||window.jQuery||$)}(this,function(a,b){var c=function(){var a=Math.random().toString().replace(".","");this.id="scroller_"+a,this.scroller,this.data,this.index=0,this.value=[0,0,0],this.oldvalue,this.oldtext=[],this.text=["","",""],this.level=3,this.mtop=30,this.separator=" "};return c.prototype={init:function(b){this.settings=a.extend({eventName:"click"},b),this.trigger=a(this.settings.trigger),void 0==this.settings["default"]?this["default"]=1:this["default"]=0,level=parseInt(this.settings.level),this.level=level>0?level:3,this.trigger.attr("readonly","readonly"),this.value=this.settings.value&&this.settings.value.split(",")||[0,0,0],this.text=this.settings.text||this.trigger.val().split(" ")||["","",""],this.oldvalue=this.value.concat([]),this.oldtext=this.text.concat([]),this.clientHeight=document.documentElement.clientHeight||document.body.clientHeight,this.clientWidth=document.documentElement.clientWidth||document.body.clientWidth,this.bindEvent()},getData:function(){var b=this,c=a.Deferred();return"object"==typeof this.settings.data?(this.data=this.settings.data,c.resolve()):a.ajax({dataType:"json",cache:!0,url:this.settings.data,type:"GET",success:function(a){b.data=a.data,c.resolve()},accepts:{json:"application/json, text/javascript, */*; q=0.01"}}),c},bindEvent:function(){var b=this;this.trigger[b.settings.eventName](function(c){for(var d="",e=0;e<b.level;e++)d+="<div></div>";a.confirm('<div class="ui-scroller-mask"><div id="'+b.id+'" class="ui-scroller">'+d+"<p></p></div></div>",null,function(a,c){"yes"==a&&b.submit(),"no"==a&&b.cancel(),this.dispose()},{width:640,height:320}),b.scroller=a("#"+b.id),b.getData().done(function(){b.format()});var f=0,g=0;return b.scroller.children().bind("touchstart",function(a){f=(a.changedTouches||a.originalEvent.changedTouches)[0].pageY}),b.scroller.children().bind("touchmove",function(b){g=(b.changedTouches||b.originalEvent.changedTouches)[0].pageY;var c=g-f,d=a(b.target).parent();if("DL"==d[0].nodeName){var e=parseInt(d.css("top")||0)+c;return d.css("top",e),f=g,!1}}),b.scroller.on("touchmove",function(a){a.preventDefault()}),b.scroller.children().bind("touchend",function(c){g=(c.changedTouches||c.originalEvent.changedTouches)[0].pageY;var d=g-f,e=a(c.target).parent();if("DL"==e[0].nodeName){var h=a(e.parent()).index(),i=parseInt(e.css("top")||0)+d;i>b.mtop&&(i=b.mtop),i<-a(e).height()+60&&(i=-a(e).height()+60);var j=i/b.mtop,k=Math.round(j),l=Math.abs(k)+1;1==k&&(l=0),b.value[h]=a(e.children().get(l)).attr("ref"),0==b.value[h]?b.text[h]="":b.text[h]=a(e.children().get(l)).html();for(var m=b.level-1;m>h;m--)b.value[m]=0,b.text[m]="";return a(e.children().get(l)).hasClass("focus")||b.format(),a(e.children().get(l)).addClass("focus").siblings().removeClass("focus"),e.css("top",k*b.mtop),!1}}),!1})},format:function(){var b=this;b.scroller.children();this.f(this.data),console.log(b.text.join(" ")),a("#txt_area").val(b.text.join(" ")),console.log(a("#txt_area").val())},f:function(b){var c=this,d=b;d||(d=[]);var e,f='<dl><dd ref="0">——</dd>',g=0,h=c.mtop;if(0!==c.index&&"0"==c.value[c.index-1]&&0==this["default"])f='<dl><dd ref="0" class="focus">——</dd>',c.value[c.index]=0,c.text[c.index]="",g=0;else{if("0"==c.value[c.index]&&(f='<dl><dd ref="0" class="focus">——</dd>',g=0),d.length>0&&1==this["default"]){f="<dl>";var i=d[0].pid||0,j=d[0].id||0;g=d[0].id,e=d[0].child,c.value[this.index]||(c.value[this.index]=j,c.text[this.index]=d[0].name),f+='<dd pid="'+i+'" class="'+m+'" ref="'+j+'">'+d[0].name+"</dd>"}for(var k=c["default"],l=d.length;l>k;k++){var i=d[k].pid||0,j=d[k].id||0,m="";c.value[c.index]==j&&(m="focus",g=j,e=d[k].child,h=c.mtop*-(k-c["default"])),f+='<dd pid="'+i+'" class="'+m+'" ref="'+j+'">'+d[k].name+"</dd>"}}f+="</dl>";var n=a(f);n.css("top",h);var o=c.scroller.children();return a(o[c.index]).html(n),c.index++,c.index>c.level-1?void(c.index=0):void c.f(e)},submit:function(){this.oldvalue=this.value.concat([]),this.oldtext=this.text.concat([]),1==this.trigger[0].nodeType&&(this.trigger.val(this.text.join(this.separator)),this.trigger.attr("data-value",this.value.join(","))),this.trigger.next('input[type="hidden"]').val(this.value.join(",")),this.settings.callback&&this.settings.callback.call(this,this.scroller,this.text,this.value)},cancel:function(){this.value=this.oldvalue.concat([]),this.text=this.oldtext.concat([])}},c});